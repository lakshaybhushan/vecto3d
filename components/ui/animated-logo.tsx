import React from "react";
import { motion, SVGMotionProps } from "framer-motion";

interface LogoProps extends SVGMotionProps<SVGSVGElement> {
  size?: number | string;
  isLoading?: boolean;
  speed?: number;
}

export default function AnimatedLogo({
  size = 24,
  isLoading = false,
  speed = 1.5,
  ...props
}: LogoProps) {
  const STROKE_DURATION = 1.5 / speed;
  const FILL_DURATION = 0.5 / speed;
  const PAUSE_DURATION = 0.6 / speed;
  const RESET_DURATION = 1.01 / speed;
  const TOTAL_DURATION =
    STROKE_DURATION + FILL_DURATION + PAUSE_DURATION + RESET_DURATION;

  const hexagonVariants = {
    hidden: {
      pathLength: 0,
      opacity: 1,
    },
    visible: {
      pathLength: 1.01,
      opacity: 1,
      transition: {
        pathLength: { duration: STROKE_DURATION, ease: "easeOut" },
      },
    },
    loading: {
      pathLength: [0, 1.01, 1.01, 0, 0],
      opacity: 1,
      transition: {
        pathLength: {
          duration: TOTAL_DURATION,
          times: [
            0,
            STROKE_DURATION / TOTAL_DURATION,
            (STROKE_DURATION + FILL_DURATION + PAUSE_DURATION) / TOTAL_DURATION,
            1,
            1,
          ],
          repeat: Infinity,
          ease: ["easeOut", "linear", "easeInOut", "linear"],
        },
      },
    },
  };
  const fillVariants = {
    hidden: {
      fillOpacity: 0,
    },
    visible: {
      fillOpacity: 1,
      transition: {
        duration: FILL_DURATION,
        delay: STROKE_DURATION,
        ease: "easeOut",
      },
    },
    loading: {
      fillOpacity: [0, 0, 1, 1, 0],
      transition: {
        duration: TOTAL_DURATION,
        times: [
          0,
          STROKE_DURATION / TOTAL_DURATION,
          (STROKE_DURATION + FILL_DURATION) / TOTAL_DURATION,
          (STROKE_DURATION + FILL_DURATION + PAUSE_DURATION) / TOTAL_DURATION,
          1,
        ],
        repeat: Infinity,
        ease: ["linear", "easeOut", "linear", "easeInOut"],
      },
    },
  };

  const starStrokeVariants = {
    hidden: {
      pathLength: 0,
      opacity: 0,
    },
    visible: {
      pathLength: 1.01,
      opacity: 1,
      transition: {
        pathLength: {
          duration: STROKE_DURATION,
          delay: 0.3 / speed,
          ease: "easeInOut",
        },
        opacity: {
          duration: 0.6 / speed,
          delay: 0.3 / speed,
        },
      },
    },
    loading: {
      pathLength: [0, 1.01, 1.01, 0, 0],
      opacity: 1,
      transition: {
        pathLength: {
          duration: TOTAL_DURATION,
          times: [
            0,
            STROKE_DURATION / TOTAL_DURATION,
            (STROKE_DURATION + FILL_DURATION + PAUSE_DURATION) / TOTAL_DURATION,
            1,
            1,
          ],
          repeat: Infinity,
          // Changed the third easing function from "linear" to "easeInOut"
          ease: ["easeOut", "linear", "easeInOut", "linear"],
        },
      },
    },
  };

  const starFillVariants = {
    hidden: {
      fillOpacity: 0,
    },
    visible: {
      fillOpacity: 1,
      transition: {
        duration: FILL_DURATION,
        delay: FILL_DURATION + 0.3 / speed,
        ease: "easeOut",
      },
    },
    loading: {
      fillOpacity: [0, 0, 1, 1, 0],
      transition: {
        duration: TOTAL_DURATION,
        times: [
          0,
          STROKE_DURATION / TOTAL_DURATION,
          (STROKE_DURATION + FILL_DURATION) / TOTAL_DURATION,
          (STROKE_DURATION + FILL_DURATION + PAUSE_DURATION) / TOTAL_DURATION,
          1,
        ],
        repeat: Infinity,
        ease: ["linear", "easeOut", "linear", "easeInOut"],
      },
    },
  };

  return (
    <motion.svg
      width={size}
      height={size}
      viewBox="0 0 128 128"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      initial="hidden"
      animate={isLoading ? "loading" : "visible"}
      {...props}>
      {/* Hexagon stroke animation */}
      <motion.path
        d="M111.76 46.9546V58.7413C111.76 59.8021 111.339 60.8196 110.588 61.5697C109.838 62.3199 108.821 62.7413 107.76 62.7413C106.699 62.7413 105.682 62.3199 104.932 61.5697C104.181 60.8196 103.76 59.8021 103.76 58.7413V46.9546C103.794 45.5713 103.559 44.1946 103.067 42.9013L64.1333 66.2613V109.941C64.7461 109.759 65.3365 109.509 65.8933 109.195L79.3867 101.728C80.3055 101.258 81.3688 101.157 82.3598 101.445C83.3508 101.732 84.1949 102.386 84.72 103.275C85.1985 104.197 85.299 105.27 85.0004 106.265C84.7017 107.261 84.0273 108.101 83.12 108.608L69.68 116.075C66.73 117.723 63.406 118.586 60.0267 118.581C56.6323 118.572 53.2946 117.71 50.32 116.075L18.5867 98.4746C15.4986 96.723 12.9263 94.1889 11.1287 91.1274C9.33113 88.0658 8.37159 84.5848 8.34668 81.0346V46.9546C8.34668 43.3866 9.30668 39.8879 11.12 36.8213C11.4258 36.2702 11.7813 35.7546 12.1867 35.2746C13.8508 32.8898 16.0404 30.9192 18.5867 29.5146L50.5867 11.8613C53.5524 10.2602 56.8697 9.42188 60.24 9.42188C63.6103 9.42188 66.9277 10.2602 69.8933 11.8613L101.893 29.5146C104.133 30.7466 106.101 32.4373 107.653 34.4746C107.892 34.72 108.105 34.9866 108.293 35.2746C108.699 35.7546 109.054 36.2702 109.36 36.8213C111.067 39.9146 111.899 43.4186 111.76 46.9546Z"
        stroke="currentColor"
        strokeWidth={1.5}
        fill="transparent"
        strokeLinecap="round"
        strokeLinejoin="round"
        variants={hexagonVariants}
      />

      {/* Hexagon fill that appears exactly when stroke completes */}
      <motion.path
        d="M111.76 46.9546V58.7413C111.76 59.8021 111.339 60.8196 110.588 61.5697C109.838 62.3199 108.821 62.7413 107.76 62.7413C106.699 62.7413 105.682 62.3199 104.932 61.5697C104.181 60.8196 103.76 59.8021 103.76 58.7413V46.9546C103.794 45.5713 103.559 44.1946 103.067 42.9013L64.1333 66.2613V109.941C64.7461 109.759 65.3365 109.509 65.8933 109.195L79.3867 101.728C80.3055 101.258 81.3688 101.157 82.3598 101.445C83.3508 101.732 84.1949 102.386 84.72 103.275C85.1985 104.197 85.299 105.27 85.0004 106.265C84.7017 107.261 84.0273 108.101 83.12 108.608L69.68 116.075C66.73 117.723 63.406 118.586 60.0267 118.581C56.6323 118.572 53.2946 117.71 50.32 116.075L18.5867 98.4746C15.4986 96.723 12.9263 94.1889 11.1287 91.1274C9.33113 88.0658 8.37159 84.5848 8.34668 81.0346V46.9546C8.34668 43.3866 9.30668 39.8879 11.12 36.8213C11.4258 36.2702 11.7813 35.7546 12.1867 35.2746C13.8508 32.8898 16.0404 30.9192 18.5867 29.5146L50.5867 11.8613C53.5524 10.2602 56.8697 9.42188 60.24 9.42188C63.6103 9.42188 66.9277 10.2602 69.8933 11.8613L101.893 29.5146C104.133 30.7466 106.101 32.4373 107.653 34.4746C107.892 34.72 108.105 34.9866 108.293 35.2746C108.699 35.7546 109.054 36.2702 109.36 36.8213C111.067 39.9146 111.899 43.4186 111.76 46.9546Z"
        fill="currentColor"
        fillOpacity={0}
        variants={fillVariants}
      />

      {/* Star stroke animation */}
      <motion.path
        d="M89.824 77.4208L95.0056 80.2323L93.3263 74.5688C91.927 73.8096 91.4073 72.0571 92.1741 70.644C92.539 69.9715 93.156 69.4716 93.8895 69.2541C94.6229 69.0366 95.4127 69.1194 96.0851 69.4843C97.4983 70.2511 98.0179 72.0035 97.2587 73.4028L98.938 79.0663L101.749 73.8848C101.536 73.1508 101.62 72.3621 101.985 71.6901C102.349 71.0181 102.965 70.5173 103.696 70.2965C104.058 70.1861 104.439 70.1487 104.815 70.1867C105.192 70.2246 105.557 70.3371 105.89 70.5176C106.223 70.6982 106.516 70.943 106.753 71.2381C106.99 71.5331 107.166 71.8723 107.271 72.236C107.721 73.7534 106.849 75.3605 105.324 75.8243L102.512 81.0058L108.19 79.334C108.555 78.6616 109.172 78.1617 109.905 77.9442C110.639 77.7267 111.428 77.8095 112.101 78.1744C112.773 78.5392 113.273 79.1563 113.491 79.8897C113.708 80.6232 113.625 81.413 113.26 82.0854C112.494 83.4986 110.741 84.0182 109.342 83.2589L103.678 84.9382L108.86 87.7497C109.594 87.5358 110.383 87.6204 111.055 87.985C111.727 88.3496 112.227 88.9648 112.448 89.6967C112.912 91.2216 112.04 92.8287 110.509 93.2712C108.991 93.7211 107.384 92.8491 106.92 91.3242L101.739 88.5127L103.411 94.19C104.81 94.9493 105.337 96.6879 104.57 98.101C104.206 98.7735 103.588 99.2734 102.855 99.4909C102.122 99.7084 101.332 99.6256 100.659 99.2607C99.2462 98.4939 98.7404 96.749 99.4997 95.3497L97.8065 89.6787L94.995 94.8602C95.4374 96.3914 94.5654 97.9985 93.048 98.4485C91.5231 98.9122 89.916 98.0402 89.4736 96.509C89.2597 95.775 89.3442 94.9862 89.7088 94.3143C90.0734 93.6423 90.6886 93.1415 91.4206 92.9207L94.2321 87.7392L88.5686 89.4185C87.8093 90.8178 86.0568 91.3374 84.6437 90.5706C83.9713 90.2058 83.4713 89.5887 83.2539 88.8553C83.0364 88.1218 83.1192 87.332 83.484 86.6596C83.8489 85.9872 84.4659 85.4872 85.1994 85.2698C85.9328 85.0523 86.7226 85.1351 87.3951 85.4999L93.0661 83.8068L87.8845 80.9953C86.3533 81.4377 84.7462 80.5657 84.2963 79.0483C84.1858 78.6863 84.1485 78.3059 84.1864 77.9293C84.2244 77.5528 84.3369 77.1875 84.5174 76.8548C84.6979 76.5222 84.9428 76.2288 85.2378 75.9917C85.5328 75.7546 85.872 75.5785 86.2358 75.4738C86.9697 75.2599 87.7585 75.3445 88.4305 75.7091C89.1025 76.0737 89.6033 76.6889 89.824 77.4208Z"
        stroke="currentColor"
        strokeWidth={1}
        strokeLinecap="round"
        strokeLinejoin="round"
        fill="transparent"
        variants={starStrokeVariants}
      />

      <motion.path
        d="M89.824 77.4208L95.0056 80.2323L93.3263 74.5688C91.927 73.8096 91.4073 72.0571 92.1741 70.644C92.539 69.9715 93.156 69.4716 93.8895 69.2541C94.6229 69.0366 95.4127 69.1194 96.0851 69.4843C97.4983 70.2511 98.0179 72.0035 97.2587 73.4028L98.938 79.0663L101.749 73.8848C101.536 73.1508 101.62 72.3621 101.985 71.6901C102.349 71.0181 102.965 70.5173 103.696 70.2965C104.058 70.1861 104.439 70.1487 104.815 70.1867C105.192 70.2246 105.557 70.3371 105.89 70.5176C106.223 70.6982 106.516 70.943 106.753 71.2381C106.99 71.5331 107.166 71.8723 107.271 72.236C107.721 73.7534 106.849 75.3605 105.324 75.8243L102.512 81.0058L108.19 79.334C108.555 78.6616 109.172 78.1617 109.905 77.9442C110.639 77.7267 111.428 77.8095 112.101 78.1744C112.773 78.5392 113.273 79.1563 113.491 79.8897C113.708 80.6232 113.625 81.413 113.26 82.0854C112.494 83.4986 110.741 84.0182 109.342 83.2589L103.678 84.9382L108.86 87.7497C109.594 87.5358 110.383 87.6204 111.055 87.985C111.727 88.3496 112.227 88.9648 112.448 89.6967C112.912 91.2216 112.04 92.8287 110.509 93.2712C108.991 93.7211 107.384 92.8491 106.92 91.3242L101.739 88.5127L103.411 94.19C104.81 94.9493 105.337 96.6879 104.57 98.101C104.206 98.7735 103.588 99.2734 102.855 99.4909C102.122 99.7084 101.332 99.6256 100.659 99.2607C99.2462 98.4939 98.7404 96.749 99.4997 95.3497L97.8065 89.6787L94.995 94.8602C95.4374 96.3914 94.5654 97.9985 93.048 98.4485C91.5231 98.9122 89.916 98.0402 89.4736 96.509C89.2597 95.775 89.3442 94.9862 89.7088 94.3143C90.0734 93.6423 90.6886 93.1415 91.4206 92.9207L94.2321 87.7392L88.5686 89.4185C87.8093 90.8178 86.0568 91.3374 84.6437 90.5706C83.9713 90.2058 83.4713 89.5887 83.2539 88.8553C83.0364 88.1218 83.1192 87.332 83.484 86.6596C83.8489 85.9872 84.4659 85.4872 85.1994 85.2698C85.9328 85.0523 86.7226 85.1351 87.3951 85.4999L93.0661 83.8068L87.8845 80.9953C86.3533 81.4377 84.7462 80.5657 84.2963 79.0483C84.1858 78.6863 84.1485 78.3059 84.1864 77.9293C84.2244 77.5528 84.3369 77.1875 84.5174 76.8548C84.6979 76.5222 84.9428 76.2288 85.2378 75.9917C85.5328 75.7546 85.872 75.5785 86.2358 75.4738C86.9697 75.2599 87.7585 75.3445 88.4305 75.7091C89.1025 76.0737 89.6033 76.6889 89.824 77.4208Z"
        fill="currentColor"
        fillOpacity={0}
        strokeWidth={0}
        strokeLinejoin="round"
        strokeLinecap="round"
        variants={starFillVariants}
      />
    </motion.svg>
  );
}
